# CC2530开发 - HQ

[TOC]

------

#### 注意

- 

------

## CC2530介绍

> ![image-20220606201831815](assets/assets.CC2530开发 - HQ/image-20220606201831815.png)





## 如何操作硬件

### 代码控制外设的一般步骤

> ![image-20220606203348661](assets/assets.CC2530开发 - HQ/image-20220606203348661.png)

### 编写外设驱动程序的步骤

> ![image-20220606203419323](assets/assets.CC2530开发 - HQ/image-20220606203419323.png)

### PIO控制器

> ![image-20220606204610859](assets/assets.CC2530开发 - HQ/image-20220606204610859.png)





## LED

### 电路图

> ![image-20220606204545426](assets/assets.CC2530开发 - HQ/image-20220606204545426.png)

### 端口配置方法

P1SEL(0XF4 - 端口1功能选择)

> ![image-20220606205121449](assets/assets.CC2530开发 - HQ/image-20220606205121449.png)

 P1DIR(0xFE - 端口1方向)

> ![image-20220606205702123](assets/assets.CC2530开发 - HQ/image-20220606205702123.png)

P1INP(0XF6 - 端口1输入模式)

> ![image-20220606210052016](assets/assets.CC2530开发 - HQ/image-20220606210052016.png)

P1 寄存器

> ![image-20220606210114060](assets/assets.CC2530开发 - HQ/image-20220606210114060.png)

### LED寄存器设置汇总

> ![image-20220606210810155](assets/assets.CC2530开发 - HQ/image-20220606210810155.png)

### 编写代码

> ![image-20220606211218626](assets/assets.CC2530开发 - HQ/image-20220606211218626.png)





## 蜂鸣器

### 分类

> ![image-20220606213638911](assets/assets.CC2530开发 - HQ/image-20220606213638911.png)

### 电路图

> ![image-20220606213937466](assets/assets.CC2530开发 - HQ/image-20220606213937466.png)

### 寄存器设置

> ![image-20220606214138121](assets/assets.CC2530开发 - HQ/image-20220606214138121.png)





## 继电器

### 作用

弱电控制强电

> ![image-20220607082441368](assets/assets.CC2530开发 - HQ/image-20220607082441368.png)

### 电路图

> ![image-20220607082828947](assets/assets.CC2530开发 - HQ/image-20220607082828947.png)

### 驱动编写

> ![image-20220607083057649](assets/assets.CC2530开发 - HQ/image-20220607083057649.png)





## 人体热释红外传感器

### 介绍

> ![image-20220607083524641](assets/assets.CC2530开发 - HQ/image-20220607083524641.png)

### 功能特点

> ![image-20220607083712233](assets/assets.CC2530开发 - HQ/image-20220607083712233.png)

### 电路图

> ![image-20220607084003055](assets/assets.CC2530开发 - HQ/image-20220607084003055.png)

### 寄存器配置

P0SEL(0xF3 - 端口0功能选择)

> ![image-20220607084357556](assets/assets.CC2530开发 - HQ/image-20220607084357556.png)

P0DIR(0XFD - 端口0方向)

> ![image-20220607084443813](assets/assets.CC2530开发 - HQ/image-20220607084443813.png)

P0

> ![image-20220607084502230](assets/assets.CC2530开发 - HQ/image-20220607084502230.png)

### 驱动编写

> ![image-20220607084828303](assets/assets.CC2530开发 - HQ/image-20220607084828303.png)





## 按键

### 电路图

> ![image-20220607091006714](assets/assets.CC2530开发 - HQ/image-20220607091006714.png)

### GPIO

> ![image-20220607091328182](assets/assets.CC2530开发 - HQ/image-20220607091328182.png)

### 驱动编写

> ![image-20220607091349138](assets/assets.CC2530开发 - HQ/image-20220607091349138.png)

### 按键消抖

>   ![image-20220607092208053](assets/assets.CC2530开发 - HQ/image-20220607092208053.png)





## 通讯协议

### 数据收发

> ![image-20220607092307184](assets/assets.CC2530开发 - HQ/image-20220607092307184.png)

### 同步与异步

> ![image-20220607092758461](assets/assets.CC2530开发 - HQ/image-20220607092758461.png)

### 串行与并行

> ![image-20220607092838411](assets/assets.CC2530开发 - HQ/image-20220607092838411.png)

### 最常见的片上通信协议

> ![image-20220607092907452](assets/assets.CC2530开发 - HQ/image-20220607092907452.png)





## UART

### 简介

> ![image-20220607093002761](assets/assets.CC2530开发 - HQ/image-20220607093002761.png)

### UART应用场景

> ![image-20220607093345102](assets/assets.CC2530开发 - HQ/image-20220607093345102.png)

### UART外设接口

> ![image-20220607093553813](assets/assets.CC2530开发 - HQ/image-20220607093553813.png)

### USB转UART

> ![image-20220607093817310](assets/assets.CC2530开发 - HQ/image-20220607093817310.png)

### 帧格式

> ![image-20220607093929473](assets/assets.CC2530开发 - HQ/image-20220607093929473.png)

#### 帧格式举例

> ![image-20220607094130222](assets/assets.CC2530开发 - HQ/image-20220607094130222.png)





## USART

### 说明

> ![image-20220607094404347](assets/assets.CC2530开发 - HQ/image-20220607094404347.png)

### 电路图

> ![image-20220607094451929](assets/assets.CC2530开发 - HQ/image-20220607094451929.png)

### 寄存器

> ![image-20220607094817799](assets/assets.CC2530开发 - HQ/image-20220607094817799.png)

### 寄存器配置

U0CSR(0X86 - USART 0 控制和状态)

>![image-20220607095438292](assets/assets.CC2530开发 - HQ/image-20220607095438292.png)

U0UCR(0XC4 - USART 0 UART 控制)

设置帧格式

> ![image-20220607095605900](assets/assets.CC2530开发 - HQ/image-20220607095605900.png)

U0BUF(0XC1 - USART 0 接收/传送数据缓存)

> ![image-20220607095730660](assets/assets.CC2530开发 - HQ/image-20220607095730660.png)

U0GCR(0XC5)、U0BAUD(0XC2 - USART 0 波特率控制)

> ![image-20220607095825366](assets/assets.CC2530开发 - HQ/image-20220607095825366.png)

PERCFG(0XF1 - 外设控制)

> ![image-20220607102813836](assets/assets.CC2530开发 - HQ/image-20220607102813836.png)

P0SEL(0XF3 - 端口0功能选择)

> ![image-20220607103044193](assets/assets.CC2530开发 - HQ/image-20220607103044193.png)

P2DIR(0XFF - 端口2方向和端口0外设优先级控制)

> ![image-20220607103229761](assets/assets.CC2530开发 - HQ/image-20220607103229761.png)

### USART初始化

> ![image-20220607103328190](assets/assets.CC2530开发 - HQ/image-20220607103328190.png)

### USART发送

> ![image-20220607103440384](assets/assets.CC2530开发 - HQ/image-20220607103440384.png)

### USART接收

>![image-20220607103701148](assets/assets.CC2530开发 - HQ/image-20220607103701148.png)





## ADC

### 介绍

> ![image-20220607105815007](assets/assets.CC2530开发 - HQ/image-20220607105815007.png)

### 工作原理

> ![image-20220607112000578](assets/assets.CC2530开发 - HQ/image-20220607112000578.png)

### 转换过程

> ![image-20220607112014076](assets/assets.CC2530开发 - HQ/image-20220607112014076.png)

### 技术指标

> ![image-20220607112255181](assets/assets.CC2530开发 - HQ/image-20220607112255181.png)

### CC2530的A/D转换模块

> ![image-20220607112429002](assets/assets.CC2530开发 - HQ/image-20220607112429002.png)

#### ADC模块的信号输入

> ![image-20220607112750856](assets/assets.CC2530开发 - HQ/image-20220607112750856.png)

### CC2530 ADC功能说明

> ![image-20220607113418412](assets/assets.CC2530开发 - HQ/image-20220607113418412.png)

### CC2530 ADC 实例

> ![image-20220607113645944](assets/assets.CC2530开发 - HQ/image-20220607113645944.png)

ADCC0N1(0XB4 - ADC控制1)

> ![image-20220607114948512](assets/assets.CC2530开发 - HQ/image-20220607114948512.png)

ADCCON3(0XB6 - ADC控制3)

> ![image-20220607115226210](assets/assets.CC2530开发 - HQ/image-20220607115226210.png)

ADCL、ADCH(0XBB) 数据低/高位寄存器

> ![image-20220607115335621](assets/assets.CC2530开发 - HQ/image-20220607115335621.png)

### ADC驱动编写步骤

> ![image-20220607115645699](assets/assets.CC2530开发 - HQ/image-20220607115645699.png)

### 编写代码

> ![image-20220607115735077](assets/assets.CC2530开发 - HQ/image-20220607115735077.png)





## 光敏传感器

### 介绍

> ![image-20220607141908863](assets/assets.CC2530开发 - HQ/image-20220607141908863.png)

### 电路图

> ![image-20220607141942288](assets/assets.CC2530开发 - HQ/image-20220607141942288.png)

### ADC输入使用

> ![image-20220607142305599](assets/assets.CC2530开发 - HQ/image-20220607142305599.png)

### 寄存器配置

APCFG寄存器

> ![image-20220607142418221](assets/assets.CC2530开发 - HQ/image-20220607142418221.png)

ADCCON1(0XB4 - ADC控制1)

> ![image-20220607142529243](assets/assets.CC2530开发 - HQ/image-20220607142529243.png)

ADCCON3(0XB6 - ADC控制3)

> ![image-20220607142626015](assets/assets.CC2530开发 - HQ/image-20220607142626015.png)

### 驱动编写

> ![image-20220607142715039](assets/assets.CC2530开发 - HQ/image-20220607142715039.png)





## 烟雾传感器

### 种类

> ![image-20220607143432424](assets/assets.CC2530开发 - HQ/image-20220607143432424.png)

### 气敏式烟雾传感器

> ![image-20220607143510883](assets/assets.CC2530开发 - HQ/image-20220607143510883.png)

### 类型

> ![image-20220607144153602](assets/assets.CC2530开发 - HQ/image-20220607144153602.png)

### MQ-2气体传感器

> ![image-20220607144243871](assets/assets.CC2530开发 - HQ/image-20220607144243871.png)

### 电路图

> ![image-20220607144349757](assets/assets.CC2530开发 - HQ/image-20220607144349757.png)

### 寄存器设置

> ![image-20220607144410179](assets/assets.CC2530开发 - HQ/image-20220607144410179.png)

### 驱动编写

与光敏比较

> ![image-20220608085105052](assets/assets.CC2530开发 - HQ/image-20220608085105052-16546494666031.png)
>
> ![image-20220608085125958](assets/assets.CC2530开发 - HQ/image-20220608085125958.png)





## 温湿度传感器

### 介绍

> ![image-20220608085738366](assets/assets.CC2530开发 - HQ/image-20220608085738366.png)

### 电路图

> ![image-20220608085850617](assets/assets.CC2530开发 - HQ/image-20220608085850617.png)

### 一次通信时序

> ![image-20220608085953478](assets/assets.CC2530开发 - HQ/image-20220608085953478.png)

### 起始信号波形

> ![image-20220608090334575](assets/assets.CC2530开发 - HQ/image-20220608090334575.png)

### 数据信号波形

> ![image-20220608090724765](assets/assets.CC2530开发 - HQ/image-20220608090724765.png)

### 如何获取数据

> ![image-20220608091036028](assets/assets.CC2530开发 - HQ/image-20220608091036028.png)

### 数据格式

> ![image-20220608091215531](assets/assets.CC2530开发 - HQ/image-20220608091215531.png)

### 代码分析

> ![image-20220608093038696](assets/assets.CC2530开发 - HQ/image-20220608093038696.png)
>
> ![image-20220608093059419](assets/assets.CC2530开发 - HQ/image-20220608093059419.png)
>
> ![image-20220608093014254](assets/assets.CC2530开发 - HQ/image-20220608093014254.png)





## 屏幕

### 介绍

> ![image-20220608093436295](assets/assets.CC2530开发 - HQ/image-20220608093436295.png)

### 颜色基础

> ![image-20220608093500246](assets/assets.CC2530开发 - HQ/image-20220608093500246.png)

### RGB值

> ![image-20220608093537604](assets/assets.CC2530开发 - HQ/image-20220608093537604.png)

### 嵌入式系统的像素颜色

> ![image-20220608093905019](assets/assets.CC2530开发 - HQ/image-20220608093905019.png)
>
> ![image-20220608093922801](assets/assets.CC2530开发 - HQ/image-20220608093922801.png)

### 像素显示

>![image-20220608094836586](assets/assets.CC2530开发 - HQ/image-20220608094836586.png)

### 硬件设计

> ![image-20220608095032286](assets/assets.CC2530开发 - HQ/image-20220608095032286.png)

### 硬件SPI和软件SPI

> ![image-20220608105301230](assets/assets.CC2530开发 - HQ/image-20220608105301230.png)

### 需要移植的文件

芯片厂家已经写好了驱动，只需要移植修改即可

> ![image-20220608105509738](assets/assets.CC2530开发 - HQ/image-20220608105509738.png)

### 修改驱动 - 设置引脚

> ![image-20220608105958896](assets/assets.CC2530开发 - HQ/image-20220608105958896.png)

### 常用函数

> ![image-20220608110156076](assets/assets.CC2530开发 - HQ/image-20220608110156076.png)

### 程序讲解

> ![image-20220608115347620](assets/assets.CC2530开发 - HQ/image-20220608115347620.png)

### 汉字取模

首先设置参数，一般要选择取模方式为“横向8点右高位”

> ![image-20220608120233259](assets/assets.CC2530开发 - HQ/image-20220608120233259.png)
>
> ![image-20220608120209081](assets/assets.CC2530开发 - HQ/image-20220608120209081.png)

### 图片取模

> ![image-20220608121429236](assets/assets.CC2530开发 - HQ/image-20220608121429236.png)





## 物联网通讯协议

### Zigbee在项目中的作用

作为通讯协议，使节点连接到协调器

> ![image-20220608143952077](assets/assets.CC2530开发 - HQ/image-20220608143952077.png)

### 常见短距离无线通信协议

> ![image-20220608144109423](assets/assets.CC2530开发 - HQ/image-20220608144109423.png)

### 常见的物联网通信协议

> ![image-20220608144351134](assets/assets.CC2530开发 - HQ/image-20220608144351134.png)

### 接入方式 - 云端协议

> ![image-20220608144510900](assets/assets.CC2530开发 - HQ/image-20220608144510900.png)

### 接入方式 - 网关协议

协调器加上位机就是一个网关。

> ![image-20220608144706686](assets/assets.CC2530开发 - HQ/image-20220608144706686.png)





## Zigbee协议

### 历史

>![image-20220608145720433](assets/assets.CC2530开发 - HQ/image-20220608145720433.png)

### Zigbee与IEEE 802.15.4

> ![image-20220608145933410](assets/assets.CC2530开发 - HQ/image-20220608145933410.png)

### Zigbee技术特点

> ![image-20220608150402891](assets/assets.CC2530开发 - HQ/image-20220608150402891.png)

### Zigbee设备类型

> ![image-20220608150554862](assets/assets.CC2530开发 - HQ/image-20220608150554862.png)

#### Zigbee协调器（Coordinator）

>![image-20220608150705395](assets/assets.CC2530开发 - HQ/image-20220608150705395.png)

#### Zigbee路由器（Router）

>![image-20220608150918902](assets/assets.CC2530开发 - HQ/image-20220608150918902.png)

#### Zigbee终端设备（End-device）

> ![image-20220608150949705](assets/assets.CC2530开发 - HQ/image-20220608150949705.png)

### Zigbee网络拓扑

> ![image-20220608151043962](assets/assets.CC2530开发 - HQ/image-20220608151043962.png)

### 设备类型与拓扑关系

> ![image-20220608151236764](assets/assets.CC2530开发 - HQ/image-20220608151236764.png)

### Zigbee网状（MESH）网络

> ![image-20220608151339783](assets/assets.CC2530开发 - HQ/image-20220608151339783.png)

### Zigbee网络建立 - 协调器建立一个新网络的流程

> ![image-20220608152450501](assets/assets.CC2530开发 - HQ/image-20220608152450501.png)

### Zigbee网络建立 - 节点加入网络方式

> ![image-20220608155916286](assets/assets.CC2530开发 - HQ/image-20220608155916286.png)

#### 通过MAC层关联加入网络

> ![image-20220608160005722](assets/assets.CC2530开发 - HQ/image-20220608160005722.png)

### Zigbee应用领域

> ![image-20220608160154540](assets/assets.CC2530开发 - HQ/image-20220608160154540.png)





## Zigbee协议栈

### 介绍

> ![image-20220608160318848](assets/assets.CC2530开发 - HQ/image-20220608160318848.png)
>
> ![image-20220608162634942](assets/assets.CC2530开发 - HQ/image-20220608162634942.png)

### Zigbee协议栈安装

>![image-20220608210321730](assets/assets.CC2530开发 - HQ/image-20220608210321730.png)
>
>![image-20220608210729922](assets/assets.CC2530开发 - HQ/image-20220608210729922.png)
>
>![image-20220608210532052](assets/assets.CC2530开发 - HQ/image-20220608210532052.png)

### Zigbee协议栈使用

> ![image-20220608211553796](assets/assets.CC2530开发 - HQ/image-20220608211553796.png)

###  协议栈初始化

> ![image-20220608211931124](assets/assets.CC2530开发 - HQ/image-20220608211931124.png)

### 无线发送函数 AF_DataRequest

> ![image-20220609084724442](assets/assets.CC2530开发 - HQ/image-20220609084724442.png)

### 接收数据函数 GenericAPP_MessageMSGCB()

> ![image-20220609085336051](assets/assets.CC2530开发 - HQ/image-20220609085336051.png)

### 如何给串口注册回调函数

> ![image-20220609085244687](assets/assets.CC2530开发 - HQ/image-20220609085244687.png)

### 如何添加定时器功能

> ![image-20220609085405747](assets/assets.CC2530开发 - HQ/image-20220609085405747.png)





## 项目运行

### 烧录程序

项目位置：

G:\知识汇总\0 - 个人学习\1 - 工程实践\嵌入式物联网项目开发\2. 项目完整源码\cc2530\ZStack-CC2530-2.5.1a\Projects\zstack\Samples\GenericApp\CC2530DB

> ![image-20220609090535056](assets/assets.CC2530开发 - HQ/image-20220609090535056.png)

协调器和终端节点在IAR中选择烧录不同的程序

> ![image-20220609090552296](assets/assets.CC2530开发 - HQ/image-20220609090552296.png)

终端节点LCD上显示“无线传感网”代表成功连接到协调器

协调器通过串口连接到电脑，打印的是16进制数据，并未解析

> ![image-20220609090831469](assets/assets.CC2530开发 - HQ/image-20220609090831469.png)





## 命令下发

### 串口命令格式

![image-20220609091253358](assets/assets.CC2530开发 - HQ/image-20220609091253358.png)

### 终端节点收到命令后的处理

> ![image-20220609091323164](assets/assets.CC2530开发 - HQ/image-20220609091323164.png)





## 数据采集

### 传感器采集驱动代码

> ![image-20220609091350641](assets/assets.CC2530开发 - HQ/image-20220609091350641.png)

### 定时上传

>![image-20220609091412993](assets/assets.CC2530开发 - HQ/image-20220609091412993.png)

### 采集数据格式说明

> ![image-20220609091427782](assets/assets.CC2530开发 - HQ/image-20220609091427782.png)

### 完整数据流程

上位机与无线节点通信函数调用流程

> ![image-20220609091509712](assets/assets.CC2530开发 - HQ/image-20220609091509712.png)











































































